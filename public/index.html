document.getElementById("chat-form").addEventListener("submit", async (e) => {
  e.preventDefault();

  const firstName = document.getElementById("firstName").value.trim();
  const year = document.getElementById("year").value.trim();
  const major = document.getElementById("major").value.trim();
  const memory = document.getElementById("memory").value.trim();

  const outputDiv = document.getElementById("output");
  outputDiv.innerHTML = "⏳ Generating your paragraph...";

  try {
    const response = await fetch("/api/chat", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ firstName, year, major, memory })  // ✅ matches backend
    });

    const data = await response.json();

    if (response.ok) {
      outputDiv.innerHTML = `<p>${data.reply}</p>`;
    } else {
      outputDiv.innerHTML = `<p style="color:red">Error: ${data.error}</p>`;
      console.error("Server returned error:", data.details);
    }
  } catch (err) {
    console.error("Fetch failed:", err);
    outputDiv.innerHTML = `<p style="color:red">Error: Could not connect to server.</p>`;
  }
});
